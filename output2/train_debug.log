2025-04-29 11:17:46,371 [INFO] Logger initialized. Output directory: output2
2025-04-29 11:17:46,382 [INFO] Cleared previous Keras session
2025-04-29 11:17:46,489 [INFO] GPUs found: [PhysicalDevice(name='/physical_device:GPU:0', device_type='GPU')]
2025-04-29 11:17:46,490 [INFO] Enabled memory growth for GPUs
2025-04-29 11:17:46,490 [INFO] Starting DATA PREPARATION stage
2025-04-29 11:17:46,565 [INFO] CSV loaded: 35107 rows
2025-04-29 11:17:47,274 [INFO] Filtered non‑existing files: 35107 -> 35107
2025-04-29 11:17:47,390 [INFO] Train size: 27146, Valid size: 9589
2025-04-29 11:17:47,390 [INFO] Creating DATA GENERATORS
2025-04-29 11:17:48,234 [INFO] Generators instantiated successfully
2025-04-29 11:17:48,234 [INFO] Building model architectures
2025-04-29 11:17:48,234 [INFO] Building EfficientNetB3 model
2025-04-29 11:17:53,904 [INFO] Building DenseNet169 model
2025-04-29 11:18:00,665 [INFO] Loading EfficientNetB3 weights from output2/efficientnetb3_weights_only.h5
2025-04-29 11:18:01,475 [INFO] Loading DenseNet169 weights from output2/densenet169_weights_only.h5
2025-04-29 11:18:02,663 [INFO] Beginning initial training — saving best weights to output2/efficientnetb3_weights_only.h5
2025-04-29 11:18:02,671 [INFO] Class weights: [0.27666123 2.63937773 1.29112961 7.81179856 9.60920354]
2025-04-29 11:18:06,026 [INFO] Training started
2025-04-29 11:18:06,129 [INFO] Epoch 1 start
2025-04-29 11:53:05,529 [INFO] Epoch 1 end — loss: 0.1770, val_loss: 0.1469, acc: 0.5024, val_acc: 0.3313
2025-04-29 11:53:05,559 [INFO] Epoch 2 start
2025-04-29 12:10:00,338 [INFO] Epoch 2 end — loss: 0.1626, val_loss: 0.1506, acc: 0.4257, val_acc: 0.3541
2025-04-29 12:10:00,387 [INFO] Epoch 3 start
2025-04-29 12:26:59,426 [INFO] Epoch 3 end — loss: 0.1611, val_loss: 0.1526, acc: 0.4361, val_acc: 0.3381
2025-04-29 12:26:59,475 [INFO] Epoch 4 start
2025-04-29 12:43:47,982 [INFO] Epoch 4 end — loss: 0.1578, val_loss: 0.1538, acc: 0.4463, val_acc: 0.3239
2025-04-29 12:43:47,984 [INFO] Training finished
2025-04-29 12:43:48,355 [INFO] Saved metric plot to output2/efficientnetb3_metrics.png
2025-04-29 12:43:48,355 [INFO] Evaluating EfficientNetB3
2025-04-29 12:44:52,619 [INFO] EfficientNetB3 -> Val Loss: 0.1469 | Val Acc: 0.3313
2025-04-29 12:47:44,117 [INFO] EfficientNetB3 -> Cohen Kappa: 0.3848
2025-04-29 12:47:44,338 [INFO] Saved confusion matrix to output2/EfficientNetB3_cm.png
2025-04-29 12:47:44,338 [INFO] Beginning initial training — saving best weights to output2/densenet169_weights_only.h5
2025-04-29 12:47:44,346 [INFO] Class weights: [0.27666123 2.63937773 1.29112961 7.81179856 9.60920354]
2025-04-29 12:47:45,416 [INFO] Training started
2025-04-29 12:47:45,475 [INFO] Epoch 1 start
2025-04-29 12:57:45,016 [INFO] Epoch 1 end — loss: 0.1839, val_loss: 0.1600, acc: 0.4168, val_acc: 0.3773
2025-04-29 12:57:45,048 [INFO] Epoch 2 start
2025-04-29 13:07:31,156 [INFO] Epoch 2 end — loss: 0.1774, val_loss: 0.1557, acc: 0.4062, val_acc: 0.4288
2025-04-29 13:07:31,188 [INFO] Epoch 3 start
2025-04-29 13:17:15,346 [INFO] Epoch 3 end — loss: 0.1801, val_loss: 0.1471, acc: 0.3971, val_acc: 0.5395
2025-04-29 13:17:15,376 [INFO] Epoch 4 start
2025-04-29 13:27:08,248 [INFO] Epoch 4 end — loss: 0.1785, val_loss: 0.1626, acc: 0.4157, val_acc: 0.4174
2025-04-29 13:27:08,292 [INFO] Epoch 5 start
2025-04-29 13:36:56,254 [INFO] Epoch 5 end — loss: 0.1767, val_loss: 0.1579, acc: 0.4182, val_acc: 0.3976
2025-04-29 13:36:56,312 [INFO] Epoch 6 start
2025-04-29 13:46:42,159 [INFO] Epoch 6 end — loss: 0.1739, val_loss: 0.1525, acc: 0.4162, val_acc: 0.4603
2025-04-29 13:46:42,161 [INFO] Training finished
2025-04-29 13:46:42,497 [INFO] Saved metric plot to output2/densenet169_metrics.png
2025-04-29 13:46:42,497 [INFO] Evaluating DenseNet169
2025-04-29 13:47:15,877 [INFO] DenseNet169 -> Val Loss: 0.1471 | Val Acc: 0.5395
2025-04-29 13:49:43,793 [INFO] DenseNet169 -> Cohen Kappa: 0.4248
2025-04-29 13:49:43,974 [INFO] Saved confusion matrix to output2/DenseNet169_cm.png
2025-04-29 13:49:43,974 [INFO] Starting fine‑tuning: unfreezing last 20 layers
2025-04-29 13:49:45,753 [INFO] Training started
2025-04-29 13:49:45,780 [INFO] Epoch 11 start
2025-04-29 14:06:53,532 [INFO] Epoch 11 end — loss: 0.0936, val_loss: 0.0940, acc: 0.7380, val_acc: 0.7298
2025-04-29 14:06:53,566 [INFO] Epoch 12 start
2025-04-29 14:23:49,004 [INFO] Epoch 12 end — loss: 0.0883, val_loss: 0.0944, acc: 0.7473, val_acc: 0.7294
2025-04-29 14:23:49,035 [INFO] Epoch 13 start
2025-04-29 14:40:51,764 [INFO] Epoch 13 end — loss: 0.0876, val_loss: 0.0939, acc: 0.7465, val_acc: 0.7299
2025-04-29 14:40:51,795 [INFO] Epoch 14 start
2025-04-29 14:57:48,137 [INFO] Epoch 14 end — loss: 0.0870, val_loss: 0.0946, acc: 0.7477, val_acc: 0.7291
2025-04-29 14:57:48,168 [INFO] Epoch 15 start
2025-04-29 15:14:39,800 [INFO] Epoch 15 end — loss: 0.0872, val_loss: 0.0934, acc: 0.7478, val_acc: 0.7308
2025-04-29 15:14:39,835 [INFO] Epoch 16 start
2025-04-29 15:31:39,127 [INFO] Epoch 16 end — loss: 0.0861, val_loss: 0.0941, acc: 0.7490, val_acc: 0.7308
2025-04-29 15:31:39,158 [INFO] Epoch 17 start
2025-04-29 15:48:36,458 [INFO] Epoch 17 end — loss: 0.0859, val_loss: 0.0935, acc: 0.7501, val_acc: 0.7315
2025-04-29 15:48:36,489 [INFO] Epoch 18 start
2025-04-29 16:05:40,789 [INFO] Epoch 18 end — loss: 0.0856, val_loss: 0.0933, acc: 0.7498, val_acc: 0.7324
2025-04-29 16:05:40,820 [INFO] Epoch 19 start
2025-04-29 16:22:42,829 [INFO] Epoch 19 end — loss: 0.0854, val_loss: 0.0935, acc: 0.7512, val_acc: 0.7315
2025-04-29 16:22:42,865 [INFO] Epoch 20 start
2025-04-29 16:39:44,598 [INFO] Epoch 20 end — loss: 0.0857, val_loss: 0.0934, acc: 0.7520, val_acc: 0.7318
2025-04-29 16:39:44,607 [INFO] Training finished
2025-04-29 16:39:44,917 [INFO] Saved metric plot to output2/efficientnetb3_finetune_metrics.png
2025-04-29 16:39:44,917 [INFO] Evaluating EfficientNetB3_FT
2025-04-29 16:40:49,305 [INFO] EfficientNetB3_FT -> Val Loss: 0.0934 | Val Acc: 0.7318
2025-04-29 16:44:23,499 [INFO] EfficientNetB3_FT -> Cohen Kappa: 0.4345
2025-04-29 16:44:23,657 [INFO] Saved confusion matrix to output2/EfficientNetB3_FT_cm.png
2025-04-29 16:44:23,657 [INFO] Starting fine‑tuning: unfreezing last 20 layers
2025-04-29 16:44:24,743 [INFO] Training started
2025-04-29 16:44:24,771 [INFO] Epoch 11 start
2025-04-29 16:54:28,627 [INFO] Epoch 11 end — loss: 0.1058, val_loss: 0.0985, acc: 0.7134, val_acc: 0.7206
2025-04-29 16:54:28,660 [INFO] Epoch 12 start
2025-04-29 17:04:16,507 [INFO] Epoch 12 end — loss: 0.0955, val_loss: 0.0989, acc: 0.7337, val_acc: 0.7210
2025-04-29 17:04:16,547 [INFO] Epoch 13 start
2025-04-29 17:14:00,977 [INFO] Epoch 13 end — loss: 0.0945, val_loss: 0.1006, acc: 0.7358, val_acc: 0.7213
2025-04-29 17:14:01,014 [INFO] Epoch 14 start
2025-04-29 17:23:47,531 [INFO] Epoch 14 end — loss: 0.0939, val_loss: 0.0999, acc: 0.7361, val_acc: 0.7227
2025-04-29 17:23:47,562 [INFO] Epoch 15 start
2025-04-29 17:33:38,171 [INFO] Epoch 15 end — loss: 0.0934, val_loss: 0.0997, acc: 0.7352, val_acc: 0.7231
2025-04-29 17:33:38,205 [INFO] Epoch 16 start
2025-04-29 17:43:30,657 [INFO] Epoch 16 end — loss: 0.0935, val_loss: 0.0997, acc: 0.7377, val_acc: 0.7228
2025-04-29 17:43:30,700 [INFO] Epoch 17 start
2025-04-29 17:53:19,961 [INFO] Epoch 17 end — loss: 0.0932, val_loss: 0.0996, acc: 0.7356, val_acc: 0.7229
2025-04-29 17:53:19,990 [INFO] Epoch 18 start
